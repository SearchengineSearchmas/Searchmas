<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Searchmas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="manifest" href="manifest.json">
<link rel="icon" href="favicon.ico">
<meta name="theme-color" content="#1a73e8">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Searchmas">

<style>
html,body{margin:0;padding:0;width:100%;height:100%;font-family:Arial}

/* WEBSITE MODE */
#site{display:none;min-height:100vh;align-items:center;justify-content:center;flex-direction:column;text-align:center}
#site input{padding:14px 20px;font-size:18px;border-radius:24px;border:1px solid #dfe1e5;width:80%;max-width:500px}

/* PWA MODE */
#pwa{display:none;height:100vh;flex-direction:column}
#topbar{display:flex;padding:8px;background:#fff;border-bottom:1px solid #ddd}
#urlbar{flex:1;padding:10px 14px;border-radius:20px;border:1px solid #ccc;font-size:16px}
#browser{flex:1;position:relative}
iframe{width:100%;height:100%;border:none}
#bottom{display:flex;justify-content:space-around;padding:8px 0;border-top:1px solid #ddd;background:#fff}
.btn{font-size:22px;cursor:pointer}
#tabs{position:absolute;inset:0;background:#f5f5f5;display:none;flex-wrap:wrap;padding:10px}
.tab-card{width:45%;margin:5px;padding:10px;background:white;border-radius:12px}
.tab-card button{float:right}
</style>
</head>

<body>

<!-- WEBSITE MODE -->
<div id="site">
  <h1>Searchmas</h1>
  <input id="siteSearch" placeholder="Search the web" onkeydown="siteSearchEnter(event)">
</div>

<!-- PWA MODE -->
<div id="pwa">
  <div id="topbar">
    <input id="urlbar" placeholder="Search or enter website" onkeydown="handleEnter(event)">
  </div>
  <div id="browser">
    <iframe id="view"></iframe>
    <div id="tabs"></div>
  </div>
  <div id="bottom">
    <div class="btn" onclick="goBack()">‚¨ÖÔ∏è</div>
    <div class="btn" onclick="goForward()">‚û°Ô∏è</div>
    <div class="btn" onclick="newTab()">‚ûï</div>
    <div class="btn" onclick="toggleTabs()">üóÇÔ∏è</div>
  </div>
</div>

<script>
const isPWA = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;

document.getElementById(isPWA ? "pwa" : "site").style.display="flex";

/* WEBSITE MODE LOGIC */
function siteSearchEnter(e){
  if(e.key==="Enter"){
    const q=e.target.value.trim();
    if(q) window.location.href="?q="+encodeURIComponent(q);
  }
}

/* PWA MODE LOGIC */
let tabs=[],currentTab=0;
const view=document.getElementById("view");
const urlbar=document.getElementById("urlbar");
const tabsView=document.getElementById("tabs");

function newTab(url="https://www.bing.com"){
  tabs.push({url});
  currentTab=tabs.length-1;
  loadTab();
}
function loadTab(){
  const tab=tabs[currentTab];
  view.src=tab.url;
  urlbar.value=tab.url;
}
function handleEnter(e){
  if(e.key==="Enter"){
    let val=urlbar.value.trim();
    if(!val)return;
    let url=val.startsWith("http")?val:"https://www.bing.com/search?q="+encodeURIComponent(val);
    if(url.includes("google.com")){window.open(url,"_blank");return;}
    tabs[currentTab].url=url;
    loadTab();
  }
}
function toggleTabs(){
  tabsView.style.display=tabsView.style.display==="flex"?"none":"flex";
  renderTabs();
}
function renderTabs(){
  tabsView.innerHTML="";
  tabs.forEach((t,i)=>{
    tabsView.innerHTML+=`
      <div class="tab-card">
        <button onclick="closeTab(${i})">‚úñ</button>
        <div onclick="selectTab(${i})">${t.url}</div>
      </div>`;
  });
}
function selectTab(i){currentTab=i;tabsView.style.display="none";loadTab();}
function closeTab(i){tabs.splice(i,1);if(!tabs.length)newTab();currentTab=Math.max(0,currentTab-1);loadTab();}
function goBack(){try{view.contentWindow.history.back()}catch(e){}}
function goForward(){try{view.contentWindow.history.forward()}catch(e){}}

if(isPWA)newTab();
</script>
</body>
</html>
